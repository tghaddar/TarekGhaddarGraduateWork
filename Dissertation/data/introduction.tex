%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  New template code for TAMU Theses and Dissertations starting Fall 2016.
%
%
%  Author: Sean Zachary Roberson
%  Version 3.17.09
%  Last Updated: 9/21/2017
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                           Introduction
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\pagestyle{plain} % No headers, just page numbers
\pagenumbering{arabic} % Arabic numerals
\setcounter{page}{1}


\chapter{\uppercase {INTRODUCTION}}\label{cha:introduction}

The field of radiation transport studies the distribution of radiation (particle/energy) throughout a six-dimensional phase-space consisting of time, space, energy, and direction. 
Radiation transport is commonly used in reactor physics, medical physics, radiation shielding, criticality safety applications, stellar atmospheres, as well as the general simulation of radiation in different environments. 

Radiation transport is described by the Boltzmann transport equation \cite{bell_glasstone,zweifel,davison,duderstadt} and can be solved stochastically or deterministically. 
The Monte Carlo method is used for stochastic radiation transport by tracking the behavior of a finite number of particles from their ``birth'' (for example, a neutron source) until their ``death'' (getting absorbed or escaping through a problem boundary), and statistically evaluating relevant quantities of interest (for example, neutron flux in a detector) \cite{shultis_mc}.
Codes such as MCNP \cite{MCNP} and SHIFT {\cite{shift} utilize the Monte Carlo method to perform high-fidelity radiation transport simulations for a variety of experiments and problems.

Deterministic transport discretizes the time, spatial, energy, and angular variables, yielding an extremely large system of linear equations. This system is then solved iteratively to obtain a numerical solution to the transport equation.
There are multiple methods to do this such as the method of characteristics and the transport sweep, implemented by codes such as MPACT \cite{mpact}, Partisn \cite{partisn}, Denovo \cite{denovo}, and PDT \cite{mpadams2013,mpadams2015}.

The work presented in this dissertation utilizes the transport sweep, a technique that solves the Boltzmann transport equation while avoiding having to build a large global matrix.
The discrete-ordinates method \cite{denovo} is used to turn the transport equation into a algebraic system (a transport equation for each direction and each energy group) that can be solved iteratively \cite{adams_larsen}.
We then can mesh the domain and discretize the discrete-ordinates transport equation in space using finite difference \cite{fd}, finite volume \cite{fd}, or discontinuous finite element \cite{Reed}. 
This allows us to solve small linear systems, which usually exhibit a lower block triangular structure, cell by cell in the direction of radiation flow by inverting the streaming operator in the transport equation. This inversion of the streaming operator and ``marching'' through the mesh is known as ``sweeping''. 

It is often desirable to split the problem domain so that the memory cost can be distributed across multiple processors.
Extensive research has been done in parallelizing the transport sweep \cite{KBA,partisn,denovo,mpadams2013,mpadams2015}, as the transport sweep gains complexity for distribute meshes. Maintaining sweep performance for massively parallel simulations has and continues to be a thriving research topic.

Research on sweeping on unstructured meshes has come to prominence in recent years, as the need to simulate more complex problems has risen.
Partitioning unstructured meshes in a balanced (or near equivalent amount of work per processor) fashion that preserves mesh integrity can present challenges.
The following dissertation chapters will discuss a brief history of the transport sweep, parallel transport sweeps, load balancing unstructured meshes for transport, a time-to-solution estimator, and optimizing partitions for parallel transport.

\noindent \textbf{The Deterministic Transport Sweep}

Chapter \ref{cha:transport_sweeps} introduces the steady-state neutron transport equation and the discretization process to obtain the discrete form of the transport equation. Chapter \ref{cha:transport_sweeps} also provides more details on the transport sweep.

\noindent \textbf{Parallel Transport Sweeps}

Massively parallel transport sweeps have been shown to scale up to 1.5 million cores on logically Cartesian grids using Texas A\&M's flagship deterministic transport code, PDT \cite{mpadams2013,mpadams2015}.
Chapter \ref{cha:parallel_transport} describes the basics of a parallel sweep algorithm, and specifically describes the KBA algorithm \cite{KBA} and PDT's extension of the KBA algorithm.
This chapter also describes PDT's performance model, which predicts the sweep time given a set of partitioning parameters.

\noindent \textbf{Unstructured Meshing and Load Balancing in PDT}

In order to solve a wider set of problems, an unstructured meshing capability was implemented in PDT.
However, unstructured meshes may lead to imbalanced partitions, or different numbers of mesh cells per processor subdomain.
To address this, two load-balancing algorithms have been implemented in PDT, the original load-balancing algorithm and the load-balancing-by-dimension algorithm \cite{mastersthesis,mc2017}.

\noindent \textbf{Time-to-Solution Estimator}

PDT's existing performance model does not account for unstructured meshes and imbalanced partitions.
Chapter \ref{cha:tts} describes the time-to-solution estimator, a graph-based method that estimates the time it takes to sweep across a problem given a mesh, partitioning scheme, and machine-specific parameters.

\noindent \textbf{Partitioning Optimization}

The time-to-solution estimator described in Chapter \ref{cha:tts} is used to optimize the partitioning scheme.
Chapter \ref{cha:optimization} details two optimization methods: a ``black box'' method that uses Python's scipy.optimize library and a ``human-intelligence'' method that prioritizes partition placement in locations that do not add cells to a mesh.
